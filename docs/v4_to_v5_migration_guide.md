# V4 to V5 migration guide

Hera recently went through a significant change in its API, reflected in the move to a new major version - V5. 
This guide is intended to help you migrate your existing workflows to the new version, specifically from V4.

## V5 motivation

Hera used to have handcrafted APIs for multiple Argo Workflow models. These were wrappers around an OpenAPI 
autogenerated client. This approach had a few drawbacks:
- contributors had to reimplement each Argo Workflows feature one by one
- maintenance burden was high
- adoption was affected since Hera's APIs were not always up to date with Argo Workflows
- some concepts were misaligned with Argo Workflows

By comparison, V5:
- maintain a 1:1 mapping with Argo Workflows and Events concepts
- offers a fully featured API
- is automatically generated from Argo Workflows and Events OpenAPI specs using Pydantic models, which makes the code
  easier to maintain, work with, readable, and easier to extend
- is automatically tested against Argo Workflows and Events OpenAPI specs by comparing generated YAML against the 
  expected YAML from the upstream project, ensuring feature parity

## V5 changes

### Concepts shift

#### Task

The Hera V4 `Task` combined the concept of a template with the concept of a DAG task. Therefore, users could not take
advantage of the savings ensured by sharing workflow templates because each task had its own template, effectively
blowing up the size of the YAML, which limited scaling. In V5, the `Task` is a thin wrapper around the Argo Workflows
`DAGTask` and separate concepts for `Script`, `Container`, `Resource`, etc, were introduced. This allows users to
share templates and scale their workflows more efficiently, and have an easier time write workflows in the first place
since the "magic" is hidden.

If you previously used `Task`, you can now use `Script` for pure Python functions or `Container` for any container
you want to launch.

```python
# 
```

#### Workflow

The Hera V4 `Workflow` assumed you wanted to run primarily DAGs on Argo. That is no longer the case. The `Workflow` 
will now expect you to specify an entrypoint, and provide at least one inner `DAG`, `Steps`, `Container`, etc.